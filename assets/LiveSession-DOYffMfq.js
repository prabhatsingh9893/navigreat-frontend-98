import{u as S,a as y,r as m,z as r,A as z,j as i,L as v}from"./index-DP27LZ9K.js";const o=window.ZoomMtg,E=()=>{const c=S(),a=y(),[u,g]=m.useState(!0),h=a.state?.role||0,p=a.state?.username||"Student",l=(a.state?.meetingNumber||"").replace(/[^0-9]/g,""),d=a.state?.passWord||"";m.useEffect(()=>{const t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="https://source.zoom.us/3.8.0/css/bootstrap.css",t.id="zoom-css-bootstrap",document.head.appendChild(t);const e=document.createElement("link");if(e.rel="stylesheet",e.type="text/css",e.href="https://source.zoom.us/3.8.0/css/react-select.css",e.id="zoom-css-select",document.head.appendChild(e),!o){r.error("Zoom Script not loaded. Refresh page.");return}if(!l||!d){r.error("Invalid Meeting Details."),c("/dashboard");return}return o.setZoomJSLib("https://source.zoom.us/3.8.0/lib","/av"),o.preLoadWasm(),o.i18n.load("en-US"),o.i18n.reload("en-US"),b(),()=>{o.leaveMeeting({}),document.body.style.overflow="auto";const n=document.getElementById("zoom-css-bootstrap"),s=document.getElementById("zoom-css-select");n&&document.head.removeChild(n),s&&document.head.removeChild(s),window.location.reload()}},[]);const b=async()=>{try{console.log("ðŸš€ Fetching Signature...");const e=await(await fetch(`${z}/generate-signature`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({meetingNumber:l,role:h})})).json();e.signature?f(e.signature):(r.error("Signature Error"),c("/dashboard"))}catch(t){console.error(t),r.error("Network Error"),c("/dashboard")}},f=t=>{const e=document.getElementById("zmmtg-root");e&&(e.style.display="block"),o.init({leaveUrl:window.location.origin+"/dashboard",isSupportAV:!0,success:n=>{g(!1),o.join({signature:t,meetingNumber:l,passWord:d,userName:p,sdkKey:"RzHNKYWTf6LuwaS_D9OA",userEmail:"",tk:"",success:s=>{console.log("Joined Meeting Successfully")},error:s=>{console.error(s),r.error(s.message||"Join Failed")}})},error:n=>{console.error(n),r.error("Init Failed")}})};return i.jsxs("div",{className:"bg-black h-screen w-screen relative",children:[u&&i.jsx("div",{className:"absolute inset-0 z-50 bg-black flex items-center justify-center text-white",children:i.jsx(v,{text:"Starting Zoom via CDN..."})}),i.jsx("div",{id:"zmmtg-root"})]})};export{E as default};
